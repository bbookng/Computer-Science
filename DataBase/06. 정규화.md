# 06. 정규화

## 📌 정규화의 개념과 이상 현상

### 💡 이상 (anomaly ) 현상

- 불필요한 데이터 중복으로 인해 릴레이션에 대한 데이터 삽입 · 수정 · 삭제 연산을 수행할 때 발생할 수 있는 부작용



### 💡 정규화

- 이상 현상을 제거하면서 데이터베이스를 올바르게 설계해 나가는 과정
- 이상 현상이 발생하지 않도록, 릴레이션을 관련 있는 속성들로만 구성하기 위해 릴레이션을 분해 (decomposition) 하는 과정
- **함수적 종속성**을 판단하여 정규화를 수행함



### 💡 이상 현상의 종류

1. **삽입 이상 (insertion anomaly)** 
   - 릴레이션에 새 데이터를 삽입하기 위해 불필요한 데이터도 함께 삽입해야 하는 문제
2. **갱신 이상 (update anomaly)**
   - 릴레이션의 중복된 튜플 중 일부만 변경하여 데이터가 불일치하게 되는 모순의 문제
3. **삭제 이상 (deletion anomaly)**
   - 릴레이션에서 튜플을 삭제하면 꼭 필요한 데이터까지 함께 삭제되는 데이터 손실의 문제



### 💡 함수적 종속성 (FD; Functional Dependency)

- 속성들 간의 관련성
- 함수 종속성을 이용하여, 릴레이션을 연관성이 있는 속성들로만 구성되도록 분해하여 이상 현상이 발생하지 않는 바람직한 릴레이션으로 만들어 나가는 과정이 정규화 



## 📌 함수 종속

### 💡 함수 종속

#### - "X가 Y를 함수적으로 결정한다."

- 릴레이션 내의 모든 튜플을 대상으로 하나의 X 값에 대한 Y 값이 항상 하나임
- X 와 Y는 하나의 릴레이션을 구성하는 속성들의 부분 집합
- "Y가 X에 함수적으로 종속되어 있다" 와 같은 의미
- **X → Y** 로 표현 ( X는 결정자, Y는 종속자)



### 💡 함수 종속 관계 판단 시 유의 사항

- 속성 자체의 특성과 의미를 기반으로 함수 종속성을 판단해야 함
  - 속성 값은 계속 변할 수 있으므로 현재 릴레이션에 포함된 속성 값만으로 판단하면 안됨
- 일반적으로 기본키와 후보키는 릴레이션의 다른 모든 속성들을 함수적으로 결정함
- 기본키나 후보키가 아니어도 다른 속성 값을 유일하게 결정하는 속성은 함수 종속 관계에서 결정자가 될 수 있음



### 💡 완전 함수 종속 (FFD; Full Functional Dependency)

- 릴레이션에서 속성 집합 Y가 속성 집합 X에 함수적으로 종속되어 있지만, 속성 집합 X의 전체가 아닌 일부분에는 종속되지 않음을 의미
- 일반적으로 함수 종속은 완전 함수 종속을 의미함
- 예) 당첨 여부는 {고객 아이디, 이벤트 번호} 에 완전 함수 종속 됨



### 💡 부분 함수 종속 (PFD; Partial Functional Dependency)

- 릴레이션에서 속성 집합 Y가 속성 집합 X의 전체가 아닌 일부분에도 함수적으로 종속됨을 의미
- 예) 고객 이름은 {고객 아이디, 이벤트 번호} 에 부분 함수 종속 됨



### 💡 이행적 함수 종속 (transitive FD)

- 릴레이션을 구성하는 세 개의 속성 집합 X, Y, Z에 대해 함수 종속 관계 X → Y와 Y → Z 가 존재하면 논리적으로 X → Z 가 성립되는데, 이것을 Z가 X에 이행적으로 함수 종속되었다고 함. 

![image-20221212165116083](assets/image-20221212165116083.png)



### 💡 고려할 필요가 없는 함수 종속 관계

- 결정자와 종속자가 같거나, 결정자가 종속자를 포함하는 것처럼 당연한 함수 종속 관계는 고려하지 않음



## 📌 기본 정규형과 정규화 과정

### 💡 정규화 (normalization)

- **함수 종속성**을 이용해 **릴레이션을** 연관성이 있는 속성들로만 구성되도록 **분해**해서 **이상 현상이 발생하지 않는** 바람직한 릴레이셩느로 만들어가는 과정
- 정규화를 통해 릴레이션은 **무손실 분해 (nonloss decomposition)** 되어야 함
  - 릴레이션은 의미적으로 동등한 릴레이션들로 분해되어야 하고 분해로 인한 정보의 손실이 발생하지 않아야 함
  - 분해된 릴레이션들을 자연 조인하면 분해 전의 릴레이션으로 복원 가능해야 함



### 💡 정규형 (NF; Normal Form)

- 릴레이션이 정규화된 정도
- 각 정규형마다 제약조건이 존재
  - 정규형의 차수가 높아질수록 요구되는 제약조건이 많아지고 엄격해짐
  - 정규형의 차수가 높아질수록 데이터 중복이 줄어 이상 현상이 발생하지 않는 바람직한 릴레이션이 됨
- 릴레이션의 특성을 고려하여 적합한 정규형을 선택



#### - 정규형의 종류

<img src="assets/image-20221218213606756.png" alt="image-20221218213606756" style="zoom:50%;" />



#### - 정규형들의 관계

<img src="assets/image-20221218213626257.png" alt="image-20221218213626257" style="zoom: 67%;" />



#### ✨ 제 1 정규형 (1NF; First Normal Form)

- 릴레이션의 모든 속성이 더는 분해되지 않는 원자 값 (atomic value)만 가지면 제 1 정규형을 만족함
- 제 1 정규형을 만족해야 관계 데이터베이스의 릴레이션이 될 자격이 있음



#### ✨ 제 2 정규형 (2NF; Second Normal Form)

- 릴레이션이 제 1 정규형에 속하고, 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속되면 제 2 정규형을 만족함



#### ✨ 제 3 정규형 (3NF; Third Normal Form)

- 릴레이션이 제 2 정규형에 속하고, 기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속되지 않으면 제 3 정규형을 만족함
